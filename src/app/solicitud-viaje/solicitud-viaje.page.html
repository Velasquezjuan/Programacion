<ion-app>
  <!-- MENÚ LATERAL -->
  <app-menu-lateral [rol]="rolUsuario"></app-menu-lateral>

  <!-- encabezado-->
  <div class="ion-page" id="main-content">
    <ion-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Solicitud de Viajes</ion-title>
      </ion-toolbar>
    </ion-header>

    <ion-content [fullscreen]="true">
      <div class="form-wrapper">
      <form [formGroup]="registroForm" (ngSubmit)="onSubmit()">
      <ion-grid>
        <ion-row>
          <ion-col size="12" class="text-center">
            <img src="assets/img/Logo 2024 - Firma_azul 1.PNG" alt="Logo" class="logo-image">
          </ion-col>
        </ion-row>
        <ion-col size="12" class="text-center">
          <h3>Bienvenido a la solicitud de viaje, en esta seccion realizaremos nuestra solicitud de viaje
            en la pestaña inferior donde dice "Destino" ud debe indicar si es un viaje dentro de uno de nuestros centros 
            si es a si debe seleccionar uno para indicar donde se dirige, de lo contrario debe
            seleccionar "Otros" e ingresar la direccion donde ud desea ir.
          </h3>
        </ion-col>
        
          <!-- Punto de Salida -->
            <ion-col size="12">
              <ion-item>
                <ion-label>Punto de Salida</ion-label>
                <ion-select formControlName="puntoSalida" (ionChange)="onSalidaChange($event)">
                  <ion-select-option *ngFor="let it of centros.central" [value]="it.value">
                    {{ it.label }}
                  </ion-select-option>
                  <ion-select-option value="otro">Otro</ion-select-option>
                </ion-select>
              </ion-item>
              <ion-text color="danger"
                        *ngIf="registroForm.get('puntoSalida')?.invalid && registroForm.get('puntoSalida')?.touched">
                <small>Selecciona un centro válido.</small>
              </ion-text>
            </ion-col>

            <!-- Input “Otro” Salida -->
            <ion-col size="12" *ngIf="showOtroSalida">
              <ion-item>
                <ion-input
                  label="Dirección salida"
                  label-placement="floating"
                  placeholder="Ingresa dirección de salida"
                  formControlName="direccionSalida">
                </ion-input>
              </ion-item>
            </ion-col>

            <!-- Punto de Destino -->
            <ion-col size="12">
              <ion-item>
                <ion-label>Punto de Destino</ion-label>
                <ion-select formControlName="centro" (ionChange)="onDestinoChange($event)">
                  <ion-select-option *ngFor="let it of centros.central" [value]="it.value">
                    {{ it.label }}
                  </ion-select-option>
                  <ion-select-option value="otro">Otro</ion-select-option>
                </ion-select>
              </ion-item>
              <ion-text color="danger"
                        *ngIf="registroForm.get('centro')?.invalid && registroForm.get('centro')?.touched">
                <small>Selecciona un centro válido.</small>
              </ion-text>
            </ion-col>

            <!-- Input “Otro” Destino -->
            <ion-col size="12" *ngIf="showOtroDestino">
              <ion-item>
                <ion-input
                  label="Dirección destino"
                  label-placement="floating"
                  placeholder="Ingresa dirección de destino"
                  formControlName="direccionDestino">
                </ion-input>
              </ion-item>
            </ion-col>

        <!-- Toggle “¿Necesita carga?” -->
            <ion-col size="12" >
              <ion-item>
                <ion-label>¿Necesita carga?</ion-label>
                <ion-toggle
                  formControlName="necesitaCarga"
                  [enableOnOffLabels]="true">
                </ion-toggle>
              </ion-item>
            </ion-col>

        <ion-col size="12">
          <ion-item>
            <ion-label position="floating">Fecha de salida</ion-label>
            <ion-input type="date" formControlName="fecha"></ion-input>
          </ion-item>
          
          <ion-item>
            <ion-label position="floating">Hora de salida</ion-label>
            <ion-input type="time" formControlName="hora"></ion-input>
          </ion-item>
        </ion-col>

        <ion-col size ="12">
          <ion-item>
            <ion-label position="floating"> Tiempo aproximado de uso</ion-label>
            <ion-input formControlName="tiempoUso" type="text" 
              placeholder="Ej: 2 hrs "></ion-input>
          </ion-item>
          </ion-col>
        

          <ion-col size="12">
            <ion-item>
              <ion-label>Tipo de Vehículo</ion-label>
              <ion-select formControlName="tipoVehiculo" (ionChange)="actualizarMaxOcupantes($event.detail.value)">
                <ion-select-option *ngFor="let item of auto.vehiculo" [value]="item.value">{{ item.label }}</ion-select-option>
              </ion-select>
            </ion-item>
          </ion-col>

          <!-- Cantidad de ocupantes (máximo según tipo de vehículo) -->
          <ion-col size="12">
            <ion-item>
              <ion-label position="floating" >Cantidad de ocupantes</ion-label>
              <ion-input type="number" placeholder="Ej: 4"
                formControlName="ocupantes" [max]="maxOcupantes" min="1">
              </ion-input>
            </ion-item>
            <ion-text color="danger" *ngIf="registroForm.get('ocupantes')?.value > maxOcupantes">
              <small>Máximo permitido: {{ maxOcupantes }} ocupantes según tipo de vehículo.</small>
            </ion-text>
          </ion-col>

          <ion-col size ="12">
          <ion-item>
            <ion-label position="floating">Motivo</ion-label>
            <ion-input formControlName="motivo"  type="text" placeholder="Indique el motivo del uso del movil"></ion-input>
          </ion-item>
        </ion-col>


        <ion-col size ="12">
          <ion-item>
                <ion-label position="floating">Ocupante responsable</ion-label>
                <ion-input formControlName="ocupante"></ion-input>
              </ion-item>
        </ion-col>

        <ion-col size ="12">
          <div class="button-container">
            <ion-button fill="outline" (click)="goToHomePage()" >Inicio</ion-button>
             
            <ion-button fill="outline"  type="submit">Solicitar Viaje</ion-button>    
          </div>
        </ion-col>

      </ion-grid>

  </form>
</div>
</ion-content>
